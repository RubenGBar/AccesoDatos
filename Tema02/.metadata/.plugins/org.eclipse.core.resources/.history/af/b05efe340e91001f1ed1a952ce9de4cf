package boletin1;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;

public class Tarea2 {
	
	public static void main(String[] args) {
		
		String username = System.getProperty("user.name");
		String directorio = "C:\\Users\\rgarcia\\AD\\";
		
		
		try {			
			
			leerDocumento(directorio, username);
			
			
		}catch(Exception e) {
			
			System.out.println("Error: " + e.getMessage());
			
		}
		
		
	}
	
	private static void leerDocumento(String directorio, String usuario) {
		String rutaCompleta = "";
        String ruta = "src/boletin1/carpetas.txt";
        String line = "";
        
        try (BufferedReader reader = new BufferedReader(new FileReader(ruta))) {
        
            while ((line = reader.readLine()) != null) {
                
            	rutaCompleta = directorio + line;
            	crearFichero(rutaCompleta, usuario);
                
            }
        
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        
    }
	
	private static void crearFichero(String ruta, String usuario) {
    	
		String rutaCompleta = ruta + "\\index.html";
		
		try {
			   
			   File fichero = new File(rutaCompleta);
			   
			   if (fichero.createNewFile()) {			   
				   System.out.println("El fichero se ha creado correctamente");
			   }
			   else {				   
				   System.out.println("No se ha podido crear el fichero");
			   }
			   
			} catch (Exception e){
			   e.getMessage();
			}
		escribeArchivo(rutaCompleta, usuario);
 
    }
	
	public static void escribeArchivo(String ruta, String usuario) {
		int indiceCarpeta = ruta.lastIndexOf("A") ;
		int indiceCarpetaFinal = ruta.lastIndexOf("\\")-1;
		String nombreCarpeta = ruta.substring(indiceCarpeta, indiceCarpetaFinal);
		String doc = "<html>\r\n"
				+ "   <head>\r\n"
				+ "      <title>" + nombreCarpeta + "</title>\r\n"
				+ "   </head>\r\n"
				+ "   <body>\r\n"
				+ "      <h1>" + nombreCarpeta + "</h1>\r\n"
				+ "      <h3>Autor:" + usuario + "</h3>\r\n"
				+ "   </body>\r\n"
				+ "</html>";
		
		try {
			BufferedWriter bw = new BufferedWriter (new FileWriter (ruta));
			
			bw.write(doc);
		
		} catch (IOException e) {
			System.out.println("Ha habido algún error");
		}finally {
			try {
				bw.flush();
				bw.close();
			} catch (IOException e) {
				System.out.println("Ha habido algún error");
			}
		}
		
	}
	
}
